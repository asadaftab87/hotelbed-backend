
Hotelbeds Cache API — Explanation of “Cheapest From Price”
This document explains how to compute and cache the “from price” per hotel. It represents the
**lowest final total** (including discounts, promotions, taxes, and fees) for **2 adults (double
occupancy)** using the **cheapest board type** (RO, BB, HB, etc.).
1) Business rules:
- City trip: minimum stay 2 nights.
- Other trips: minimum stay 5 nights.
- If a “free night” promotion (e.g., 3=2) at minLOS+1 is cheaper, it can be used.
- Always double occupancy, no children.
- Checkout coupons excluded.
2) Inputs:
- Search period (start/end date), destination or hotel codes, display currency, market/POS, channel,
language.
- Optional filters (refundable only, pay-at-hotel only, brand filters, etc.).
3) Normalization of data:
- Standardized structure with rateKey, hotel, room, board, policy, availability, nightly prices,
promotions, taxes.
4) Algorithm:
- Define LOS set (minLOS and optionally +1 if free night applies).
- Iterate through check-in dates and LOS combinations.
- Compute total per board and choose the lowest.
- Result: cheapest total, check-in date, LOS, board, payNow, payAtHotel, refundable, and free night
flag.
5) Price computation steps:
- Eligibility checks (stop-sell, allotment, CTA/CTD, min/max nights).
- Compute base nightly price, supplements, promos, discounts.
- Apply free night operator if eligible.
- Add taxes and fees, convert currency if needed, apply margin/commission.
- Round only for display.
6) Caching:
- Redis keys for rate details and min-prices per hotel.
- TTLs: availability 3–10 min, rate 15 min, content 48h.
- SWR and rolling recompute ensure high performance.
7) Output:
One record per hotel with total price, currency, check-in date, nights, board, refundable, payNow,
payAtHotel, and free night usage.
8) Example:
City trip (2 nights). RO total EUR 197. HB with free night (3 nights) yields EUR 298, so RO wins. If
HB had been cheaper, result would show HB with 3 nights, EUR 190, and a “Free night” badge.


In summary: this document provides a **step-by-step recipe** to always show the most accurate
and cheapest “from price” per hotel, accounting for all promotions and rules.


